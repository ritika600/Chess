(this.webpackJsonpchessgame=this.webpackJsonpchessgame||[]).push([[0],{26:function(e,t,c){},27:function(e,t,c){},33:function(e,t,c){"use strict";c.r(t);var n=c(0),r=c.n(n),a=c(17),i=c.n(a),o=(c(26),c(4)),s=(c(27),c(18)),u=c(41),l=new s,b=new u.a;function j(){l.reset(),d()}function f(e,t,c){var n={from:e,to:t};c&&(n.promotion=c),l.move(n)&&d()}function d(e){var t=l.game_over(),c={board:l.board(),pendingPromotion:e,isGameOver:t,turn:l.turn(),result:t?O():null};localStorage.setItem("savedGame",l.fen()),b.next(c)}function O(){if(l.in_checkmate()){var e="w"===l.turn()?"BLACK":"WHITE";return"CHECKMATE - WINNER - ".concat(e)}if(l.in_draw()){var t="50 - MOVES - RULE";return l.in_stalemate()?t="STALEMATE":l.in_threefold_repetition()?t="REPETITION":l.insufficient_material()&&(t="INSUFFICIENT MATERIAL"),"DRAW - ".concat(t)}return"UNKNOWN REASON"}var m=c(2);function v(e){var t=e.children,c=e.black?"square-black":"square-white";return Object(m.jsx)("div",{id:"board-square",className:c,children:t})}var p=c(42),h=c(39);function x(e){var t=e.piece,c=t.type,n=t.color,r=e.position,a=Object(p.a)({type:"piece",item:{id:"".concat(r,"_").concat(c,"_").concat(n)},collect:function(e){return{isDragging:!!e.isDragging()}}}),i=Object(o.a)(a,3),s=i[0].isDragging,u=i[1],l=i[2],b="./assets/".concat(c,"_").concat(n,".png");return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(h.a,{connect:l,src:b}),Object(m.jsx)("div",{className:"piece-container",ref:u,style:{opacity:s?0:1},children:Object(m.jsx)("img",{src:b,className:"piece",alt:""})})]})}var g=c(43),N=["r","n","b","q"];function E(e){var t=e.promotion,c=t.from,n=t.to,r=t.color;return Object(m.jsx)("div",{className:"w-100 h-100 d-flex flex-wrap",children:N.map((function(e,t){return Object(m.jsx)("div",{className:"w-50 h-50",children:Object(m.jsx)(v,{black:t%3===0,children:Object(m.jsx)("div",{className:"piece-container",onClick:function(){return f(c,n,e)},children:Object(m.jsx)("img",{className:"piece cursor-pointer",alt:"",src:"./assets/".concat(e,"_").concat(r,".png")})})})},t)}))})}function w(e){var t=e.piece,c=e.black,r=e.position,a=Object(n.useState)(null),i=Object(o.a)(a,2),s=i[0],u=i[1],j=Object(g.a)({accept:"piece",drop:function(e){var t=e.id.split("_");!function(e,t){var c=l.moves({verbose:!0}).filter((function(e){return e.promotion}));console.table(c),c.some((function(c){return"".concat(c.from,":").concat(c.to)==="".concat(e,":").concat(t)}))&&d({from:e,to:t,color:c[0].color}),b.getValue().pendingPromotion||f(e,t),f(e,t)}(Object(o.a)(t,1)[0],r)}}),O=Object(o.a)(j,2)[1];return Object(n.useEffect)((function(){var e=b.subscribe((function(e){var t=e.pendingPromotion;t&&t.to===r?u(t):u(null)}));return function(){return e.unsubscribe()}}),[r]),Object(m.jsx)("div",{id:"board-square",ref:O,children:Object(m.jsx)(v,{black:c,children:s?Object(m.jsx)(E,{promotion:s}):t?Object(m.jsx)(x,{piece:t,position:r}):null})})}function S(e){var t=e.board,c=e.turn,r=Object(n.useState)([]),a=Object(o.a)(r,2),i=a[0],s=a[1];function u(e){return{x:"w"===c?e%8:Math.abs(e%8-7),y:"w"===c?Math.abs(Math.floor(e/8)-7):Math.floor(e/8)}}function l(e){var t=u(e);return(t.x+t.y)%2===1}function b(e){var t=u(e),c=t.x,n=t.y;return"".concat(["a","b","c","d","e","f","g","h"][c]).concat(n+1)}return Object(n.useEffect)((function(){s("w"===c?t.flat():t.flat().reverse())}),[t,c]),Object(m.jsx)("div",{className:"w-100 h-100 d-flex flex-wrap",children:i.flat().map((function(e,t){return Object(m.jsx)("div",{className:"square",children:Object(m.jsx)(w,{piece:e,black:l(t),position:b(t)})},t)}))})}var k=function(){var e=Object(n.useState)([]),t=Object(o.a)(e,2),c=t[0],r=t[1],a=Object(n.useState)(),i=Object(o.a)(a,2),s=i[0],u=i[1],f=Object(n.useState)(),O=Object(o.a)(f,2),v=O[0],p=O[1],h=Object(n.useState)(),x=Object(o.a)(h,2),g=x[0],N=x[1];return Object(n.useEffect)((function(){!function(){var e=localStorage.getItem("savedGame");e&&l.load(e),d()}();var e=b.subscribe((function(e){r(e.board),r(e.board),u(e.isGameOver),p(e.result),N(e.turn)}));return function(){return e.unsubscribe()}}),[]),Object(m.jsxs)("div",{className:" d-flex justify-content-center",id:"container",children:[s&&Object(m.jsxs)("h2",{className:"vertical-text",children:["GAME OVER",Object(m.jsx)("button",{onClick:j,children:Object(m.jsx)("span",{className:"vertical-text",children:" NEW GAME"})})]}),Object(m.jsx)("div",{className:"w-600 h-600",id:"board-container",children:Object(m.jsx)(S,{board:c,turn:g})}),v&&Object(m.jsx)("p",{className:"vertical-text",children:v})]})},I=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,44)).then((function(t){var c=t.getCLS,n=t.getFID,r=t.getFCP,a=t.getLCP,i=t.getTTFB;c(e),n(e),r(e),a(e),i(e)}))},_=c(40),M=c(20);c(32);i.a.render(Object(m.jsx)(r.a.StrictMode,{children:Object(m.jsx)(_.a,{backend:M.a,children:Object(m.jsx)(k,{})})}),document.getElementById("root")),I()}},[[33,1,2]]]);
//# sourceMappingURL=main.2da74129.chunk.js.map